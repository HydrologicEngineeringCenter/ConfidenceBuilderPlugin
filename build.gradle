
plugins {
    id 'java'
    id 'maven-publish'
}
archivesBaseName = "ConfidenceBuilderPlugin"
group 'mil.army.usace.hec'
version '1.0-SNAPSHOT'

repositories {
    jcenter()
    flatDir{
        dirs ("lib")
    }
}

version = '1.0-SNAPSHOT'

tasks.withType(Test) {
    useJUnitPlatform()
    jvmArgs '--enable-preview'
}

dependencies {
    implementation 'org.junit.jupiter:junit-jupiter:5.4.2'
    implementation name:'commons-collections-2.1'
    implementation name: 'commons-lang-2.5'
    implementation name: 'hec'
    implementation name: 'hecnf'
    implementation name: 'hecnfPlugin'
    implementation name: 'jdom-1.0'
    implementation name: 'rma'
    implementation name: 'rmadev'
    implementation name: 'wat'
    implementation name: 'watModel'
}
test{
    useJUnitPlatform()
    testLogging{
        test {
            testLogging {
                events 'PASSED','FAILED', 'SKIPPED'
            }
        }
    }
}

jar {
    manifest {
        attributes 'RtsPluginMainClass': 'main.java.ConfidenceBuilderPlugin'
    }
}

publishing {
    publications {
        ConfidenceBuilderArtifact(MavenPublication) {
            groupId = 'mil.army.usace.hec'
            artifactId = 'ConfidenceBuilderPlugin'
            version = "1.0-SNAPSHOT"
            from components.java
        }
    }
    repositories {
        maven {
            credentials {
                username = "$mavenUser"
                password = "$mavenPassword"
            }
            def releasesRepoUrl = "https://www.hec.usace.army.mil/nexus/repository/maven-releases/"
            def snapshotsRepoUrl = "https://www.hec.usace.army.mil/nexus/repository/maven-snapshots/"
            url = version.endsWith('SNAPSHOT') ? snapshotsRepoUrl : releasesRepoUrl
        }
    }
}


publish.dependsOn jar
